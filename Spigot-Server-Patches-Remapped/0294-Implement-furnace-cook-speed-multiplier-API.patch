From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Tassu <git@tassu.me>
Date: Thu, 13 Sep 2018 08:45:21 +0300
Subject: [PATCH] Implement furnace cook speed multiplier API

Signed-off-by: Tassu <git@tassu.me>

diff --git a/src/main/java/net/minecraft/tileentity/AbstractFurnaceTileEntity.java b/src/main/java/net/minecraft/tileentity/AbstractFurnaceTileEntity.java
index d6efbead091c67c198138051300228624dd31bd2..74ce30d3c3aadd02d311da532d0c80229d10a2bd 100644
--- a/src/main/java/net/minecraft/tileentity/AbstractFurnaceTileEntity.java
+++ b/src/main/java/net/minecraft/tileentity/AbstractFurnaceTileEntity.java
@@ -39,6 +39,7 @@ import net.minecraft.util.math.MathHelper;
 import net.minecraft.util.math.vector.Vector3d;
 import net.minecraft.world.World;
 // CraftBukkit start
+import java.util.List;
 import org.bukkit.craftbukkit.block.CraftBlock;
 import org.bukkit.craftbukkit.entity.CraftHumanEntity;
 import org.bukkit.craftbukkit.inventory.CraftItemStack;
@@ -57,6 +58,7 @@ public abstract class AbstractFurnaceTileEntity extends LockableTileEntity imple
     protected NonNullList<ItemStack> field_214012_a;
     public int field_214018_j;
     private int field_214019_k;
+    public double cookSpeedMultiplier = 1.0; // Paper - cook speed multiplier API
     public int field_214020_l;
     public int field_214021_m;
     protected final IIntArray field_214013_b;
@@ -257,6 +259,11 @@ public abstract class AbstractFurnaceTileEntity extends LockableTileEntity imple
             this.field_214022_n.put(new ResourceLocation(s), nbttagcompound1.func_74762_e(s));
         }
 
+        // Paper start - cook speed API
+        if (p_230337_2_.func_74764_b("Paper.CookSpeedMultiplier")) {
+            this.cookSpeedMultiplier = p_230337_2_.func_74769_h("Paper.CookSpeedMultiplier");
+        }
+        // Paper end
     }
 
     @Override
@@ -265,6 +272,7 @@ public abstract class AbstractFurnaceTileEntity extends LockableTileEntity imple
         p_189515_1_.func_74777_a("BurnTime", (short) this.field_214018_j);
         p_189515_1_.func_74777_a("CookTime", (short) this.field_214020_l);
         p_189515_1_.func_74777_a("CookTimeTotal", (short) this.field_214021_m);
+        p_189515_1_.func_74780_a("Paper.CookSpeedMultiplier", this.cookSpeedMultiplier); // Paper - cook speed multiplier API
         ItemStackHelper.func_191282_a(p_189515_1_, this.field_214012_a);
         CompoundNBT nbttagcompound1 = new CompoundNBT();
 
@@ -324,8 +332,8 @@ public abstract class AbstractFurnaceTileEntity extends LockableTileEntity imple
                 }
 
                 if (this.func_214006_r() && this.func_214008_b(irecipe)) {
-                    ++this.field_214020_l;
-                    if (this.field_214020_l == this.field_214021_m) {
+                    this.field_214020_l += cookSpeedMultiplier; // Paper - cook speed multiplier API
+                    if (this.field_214020_l >= this.field_214021_m) { // Paper - cook speed multiplier API
                         this.field_214020_l = 0;
                         this.field_214021_m = this.func_214005_h();
                         this.func_214007_c(irecipe);
diff --git a/src/main/java/net/minecraft/world/biome/Biome.java b/src/main/java/net/minecraft/world/biome/Biome.java
index 9f199193e23b1700565b6f378c7ff1b7e23a5049..43b648455108a10f786aee12ef8b2fbeade8afec 100644
--- a/src/main/java/net/minecraft/world/biome/Biome.java
+++ b/src/main/java/net/minecraft/world/biome/Biome.java
@@ -165,7 +165,7 @@ public class Biome {
             for (j = 0; j < i; ++j) {
                 EntityClassification enumcreaturetype = aenumcreaturetype[j];
 
-                this.field_201880_ax.put(enumcreaturetype, new net.minecraft.world.biome.Biome.MobList()); // Paper
+                this.field_201880_ax.put(enumcreaturetype, new MobList()); // Paper
             }
 
         } else {
diff --git a/src/main/java/org/bukkit/craftbukkit/block/CraftFurnace.java b/src/main/java/org/bukkit/craftbukkit/block/CraftFurnace.java
index 6b71b7ccf9e4c062f32a4617a0f970520e280740..134b6bb79ca9df541ac77a6e1188b0155fe44d2b 100644
--- a/src/main/java/org/bukkit/craftbukkit/block/CraftFurnace.java
+++ b/src/main/java/org/bukkit/craftbukkit/block/CraftFurnace.java
@@ -63,4 +63,18 @@ public abstract class CraftFurnace<T extends AbstractFurnaceTileEntity> extends
     public void setCookTimeTotal(int cookTimeTotal) {
         this.getSnapshot().field_214021_m = cookTimeTotal;
     }
+
+    // Paper start - cook speed multiplier API
+    @Override
+    public double getCookSpeedMultiplier() {
+        return this.getSnapshot().cookSpeedMultiplier;
+    }
+
+    @Override
+    public void setCookSpeedMultiplier(double multiplier) {
+        com.google.common.base.Preconditions.checkArgument(multiplier >= 0, "Furnace speed multiplier cannot be negative");
+        com.google.common.base.Preconditions.checkArgument(multiplier <= 200, "Furnace speed multiplier cannot more than 200");
+        this.getSnapshot().cookSpeedMultiplier = multiplier;
+    }
+    // Paper end
 }
