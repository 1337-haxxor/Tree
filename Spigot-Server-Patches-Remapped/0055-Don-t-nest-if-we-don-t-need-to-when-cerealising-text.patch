From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: kashike <kashike@vq.lc>
Date: Tue, 8 Mar 2016 18:28:43 -0800
Subject: [PATCH] Don't nest if we don't need to when cerealising text
 components


diff --git a/src/main/java/net/minecraft/network/play/server/SChatPacket.java b/src/main/java/net/minecraft/network/play/server/SChatPacket.java
index e6014649c9a6a4f45cf94877e3c02c70f9df854e..701c8e5e28f0c5959025a6aa90043f5c3ad12f3d 100644
--- a/src/main/java/net/minecraft/network/play/server/SChatPacket.java
+++ b/src/main/java/net/minecraft/network/play/server/SChatPacket.java
@@ -34,7 +34,14 @@ public class SChatPacket implements IPacket<IClientPlayNetHandler> {
     public void func_148840_b(PacketBuffer p_148840_1_) throws IOException {
         // Spigot start
         if (components != null) {
-            p_148840_1_.func_180714_a(net.md_5.bungee.chat.ComponentSerializer.toString(components));
+            //packetdataserializer.a(net.md_5.bungee.chat.ComponentSerializer.toString(components)); // Paper - comment, replaced with below
+            // Paper start - don't nest if we don't need to so that we can preserve formatting
+            if (this.components.length == 1) {
+                p_148840_1_.func_180714_a(net.md_5.bungee.chat.ComponentSerializer.toString(this.components[0]));
+            } else {
+                p_148840_1_.func_180714_a(net.md_5.bungee.chat.ComponentSerializer.toString(this.components));
+            }
+            // Paper end
         } else {
             p_148840_1_.func_179256_a(this.field_148919_a);
         }
