From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Spottedleaf <Spottedleaf@users.noreply.github.com>
Date: Wed, 15 Apr 2020 17:56:07 -0700
Subject: [PATCH] Don't run entity collision code if not needed

Will not run if max entity craming is disabled and
the max collisions per entity is less than or equal to 0

diff --git a/src/main/java/net/minecraft/entity/LivingEntity.java b/src/main/java/net/minecraft/entity/LivingEntity.java
index 45056e7c8bfe6fb0e8fceada7822a1f37f57ad9e..1d84121ab4d2b0708c4916eea165324995c64483 100644
--- a/src/main/java/net/minecraft/entity/LivingEntity.java
+++ b/src/main/java/net/minecraft/entity/LivingEntity.java
@@ -2911,10 +2911,16 @@ public abstract class LivingEntity extends Entity {
     protected void func_70626_be() {}
 
     protected void func_85033_bc() {
+        // Paper - start don't run getEntities if we're not going to use its result
+        int i = this.field_70170_p.func_82736_K().func_223592_c(GameRules.field_223616_s);
+        if (i <= 0 && field_70170_p.paperConfig.maxCollisionsPerEntity <= 0) {
+            return;
+        }
+        // Paper - end don't run getEntities if we're not going to use its result
         List<Entity> list = this.field_70170_p.func_175674_a(this, this.func_174813_aQ(), EntityPredicates.func_200823_a(this));
 
         if (!list.isEmpty()) {
-            int i = this.field_70170_p.func_82736_K().func_223592_c(GameRules.field_223616_s);
+            // Paper - move up
             int j;
 
             if (i > 0 && list.size() > i - 1 && this.field_70146_Z.nextInt(4) == 0) {
