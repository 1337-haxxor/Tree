From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Aikar <aikar@aikar.co>
Date: Sun, 3 Apr 2016 16:28:17 -0400
Subject: [PATCH] Configurable Grass Spread Tick Rate


diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
index 725958efab3dd05e04b7b18e169230762ef800d0..fe2c8001897dc6d66ce0d24ddb1a5d3b79810294 100644
--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
@@ -241,4 +241,10 @@ public class PaperWorldConfig {
         }
         fixedInhabitedTime = getInt("fixed-chunk-inhabited-time", -1);
     }
+
+    public int grassUpdateRate = 1;
+    private void grassUpdateRate() {
+        grassUpdateRate = Math.max(0, getInt("grass-spread-tick-rate", grassUpdateRate));
+        log("Grass Spread Tick Rate: " + grassUpdateRate);
+    }
 }
diff --git a/src/main/java/net/minecraft/block/SpreadableSnowyDirtBlock.java b/src/main/java/net/minecraft/block/SpreadableSnowyDirtBlock.java
index 8e819ce41fcb654ea080f215d46a7054e2ed7600..5b6fa5703e16462f04692b566838e829d069111f 100644
--- a/src/main/java/net/minecraft/block/SpreadableSnowyDirtBlock.java
+++ b/src/main/java/net/minecraft/block/SpreadableSnowyDirtBlock.java
@@ -1,6 +1,7 @@
 package net.minecraft.block;
 
 import java.util.Random;
+import net.minecraft.server.MinecraftServer;
 import net.minecraft.tags.FluidTags;
 import net.minecraft.tags.ITag;
 import net.minecraft.util.Direction;
@@ -39,6 +40,7 @@ public abstract class SpreadableSnowyDirtBlock extends SnowyDirtBlock {
 
     @Override
     public void func_225542_b_(BlockState p_225542_1_, ServerWorld p_225542_2_, BlockPos p_225542_3_, Random p_225542_4_) {
+        if (this instanceof GrassBlock && p_225542_2_.paperConfig.grassUpdateRate != 1 && (p_225542_2_.paperConfig.grassUpdateRate < 1 || (MinecraftServer.currentTick + p_225542_3_.hashCode()) % p_225542_2_.paperConfig.grassUpdateRate != 0)) { return; } // Paper
         if (!func_220257_b(p_225542_1_, (IWorldReader) p_225542_2_, p_225542_3_)) {
             // CraftBukkit start
             if (org.bukkit.craftbukkit.event.CraftEventFactory.callBlockFadeEvent(p_225542_2_, p_225542_3_, Blocks.field_150346_d.func_176223_P()).isCancelled()) {
